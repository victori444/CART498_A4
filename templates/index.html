<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jungian Dream Analysis</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>

<video autoplay muted loop playsinline id="bg-video">
    <source src="/static/background2.mp4" type="video/mp4">
</video>

<div class="prompt-section d-flex align-items-center justify-content-center">
    <div class="prompt-card col-md-6 text-center">

        <h1 class="display-6 mb-4">Tell me about your dream...</h1>

        <form method="POST">
            <div class="mb-4">
                <textarea
                    name="prompt"
                    rows="6"
                    class="form-control"
                ></textarea>
            </div>

            <div class="d-grid">
                <input type="submit" value="Analyze" class="btn btn-primary">
            </div>
        </form>

    </div>
</div>

{% if text_interpretation or image_data %}
<div id="results" class="container results-section">

    <div class="result-container">

        <div class="result-card">
            <h3 class="mb-3">My interpretation</h3>

            {% if text_interpretation %}
            <div class="text-interpretation">
                {{ text_interpretation 
                    | replace('*', '<em>')
                    | replace('\n', '<br>') 
                    | safe }}
            </div>
            {% endif %}
        </div>

        <div class="result-card">
            {% if image_data %}
            <img
                src="data:image/png;base64,{{ image_data }}"
                class="img-fluid"
                alt="Generated image"
            >
            {% endif %}
        </div>
    </div>
</div>
{% endif %}

{% if text_interpretation or image_data %}
    <script>
    window.onload = () => {
        const results = document.getElementById("results");
        if (results) {
            setTimeout(() => {
                results.scrollIntoView({ behavior: "smooth" });
            }, 300);
        }
    };
    </script>
{% endif %}

</body>
</html>
